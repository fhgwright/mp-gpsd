# This builds the dependent parts of the website files.  It's a bit of
# a kluge at the moment; it really ought to be generated by autoconf, in
# case xmlto is not available but xsltproc is.

%.html: ../%.xml
	xmlto xhtml-nochunks $<

XML = \
	gpsd.xml \
	gps.xml \
	cgpxlogger.xml \
	libgps.xml \
	libgpsmm.xml \
	libgpsd.xml \
	sirfmon.xml \
	rtcmdecode.xml \
	gpsprof.xml \
	gpsfake.xml \
	gpsctl.xml \
	gpscat.xml \
	gpspipe.xml \
	gpsflash.xml \
	rtcm-104.xml \
	srec.xml


html: index.html hardware.html $(XML:.xml=.html)

index.html: index.html.in
	sed -e "/@DATE@/s//`date '+%B %d, %Y'`/" <index.html.in >index.html

hardware.html: hardware-head.html ../gpscap.ini hardware-tail.html
	(cat hardware-head.html; (cd ..; python gpscap.py); cat hardware-tail.html) >hardware.html

# Re-do this and upload it when adding new manuals
sums: 
	sha1sum `find vendor-docs -type f -name "*.pdf" -print` >checksums

clean:
	rm -f $(XML:.xml=.html)
